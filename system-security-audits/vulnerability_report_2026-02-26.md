# Vulnerability Audit Report - Cyber-Physical Resilience

**Date:** 2026-02-26
**Scope:** Python Dependencies, Docker Infrastructure, Core Application Logic

## Executive Summary
The security audit of the project's dependencies and infrastructure found no high-severity vulnerabilities in the current pinned libraries. However, several operational and architectural risks were identified in the Docker configuration and input handling logic.

---

## 1. Dependency Analysis
We scanned `requirements.txt` and `requirements-hub.txt` against common vulnerability databases (CVE/OSV).

| Requirement File | Status | Findings |
| :--- | :--- | :--- |
| `requirements.txt` | ðŸŸ¢ CLEAN | No known vulnerabilities found in installed libraries. |
| `requirements-hub.txt`| ðŸŸ¢ CLEAN | Pinned versions verified via OSV API; no vulnerabilities found. |

> [!TIP]
> **Action Item:** Pin versions in `requirements.txt` (e.g., `requests==2.32.3`) to prevent breaking changes and Supply Chain attacks.

---

## 2. Infrastructure Audit (Docker)

### [MEDIUM] High-Privilege Docker Socket Mount
- **Target:** `docker-compose.extractor.yml:L48-49`
- **Issue:** The `extractor-manager` container mounts `/var/run/docker.sock`. This effectively gives the container root-level control over the host Docker engine.
- **Risk:** If the FastAPI service in the container is compromised, the attacker can escape the container and compromise the entire host system.
- **Remediation:** Remove the socket mount if it's not strictly necessary for the extractor's logic. If it is required (e.g., for launching sub-containers), use a proxy like `docker-socket-proxy` to restrict allowed commands.

### [LOW] Root User in Container
- **Target:** `Dockerfile`
- **Issue:** The container runs as the `root` user by default.
- **Risk:** Increases the impact of a successful exploit.
- **Remediation:** Create a non-privileged user in the `Dockerfile` and use the `USER` directive.

---

## 4. Development Tools & Scripts

### [LOW] Local Path Exposure in Logs
- **Target:** `verify_setup.py:L17-35`
- **Issue:** The diagnostics script prints absolute local file paths to the console.
- **Risk:** Minimal in a local-only environment, but could leak sensitive directory structures if logs are shared or stored in a less secure location.
- **Remediation:** Use relative paths or scrub user-specific segments from logs.

### [NOTE] Stale Pre-commit Hooks
- **Finding:** `.pre-commit-config.yaml` is using `rev: v4.5.0` for `pre-commit-hooks`.
- **Status:** Functional, but `v5.0.0` is available with improved security checks.
- **Remediation:** Run `pre-commit autoupdate` to stay current.

### [LOW] Unvalidated URL Extraction
- **Target:** `hub.py:L136-177`
- **Issue:** The `/extract` endpoint accepts any URI and passes it to `trafilatura`.
- **Risk:** Potential for Server-Side Request Forgery (SSRF) if an attacker can force the hub to scan internal network resources (e.g., `http://192.168.1.1/admin`).
- **Remediation:** Implement a whitelist for allowed domains or block requests to private IP ranges.

### [NOTE] Draft Sanitization Logic
- **Finding:** Notes in `security decisions and scrubber script.md` describe a `scrubber.py` and "Data Airlock" that are not currently implemented in the codebase.
- **Status:** The current pipeline relies on lexical filters in `scout.py`. While effective, the more robust `pypdf` sanitization described in the notes is currently missing.
